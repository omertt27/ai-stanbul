# Istanbul AI System Architecture - Visual Overview

## ğŸ¯ Complete System Stack

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         USER INTERFACE                            â”‚
â”‚  (Frontend: React/Vue with GPS location permission)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                    User Query + GPS Location
                    {"message": "...", "user_location": {lat, lon}}
                             â”‚
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    FASTAPI BACKEND (/api/chat)                   â”‚
â”‚                   backend/main.py                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    PURE LLM HANDLER                               â”‚
â”‚           backend/services/pure_llm_handler.py                    â”‚
â”‚                                                                   â”‚
â”‚  â€¢ Intent Detection (transportation/restaurant/attraction)       â”‚
â”‚  â€¢ GPS Extraction                                                 â”‚
â”‚  â€¢ Route to appropriate systems                                   â”‚
â”‚  â€¢ Response orchestration                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                â”‚              â”‚                 â”‚
        â†“                â†“              â†“                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   RAG        â”‚  â”‚  PostgreSQL  â”‚  â”‚  Istanbul    â”‚  â”‚  RunPod LLM  â”‚
â”‚   Service    â”‚  â”‚   Database   â”‚  â”‚  Daily Talk  â”‚  â”‚  (Llama 3.1) â”‚
â”‚              â”‚  â”‚              â”‚  â”‚     AI       â”‚  â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                 â”‚                 â”‚                 â”‚
       â†“                 â†“                 â†“                 â†“
   Semantic         Structured      GPS Route          Natural
   Context          Data           Service +           Language
   (Districts,      (500+ Rest,    Map System         Generation
   Transport,       200+ Places,
   Tips)            Events)
       â”‚                 â”‚                 â”‚                 â”‚
       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â†“
                    RESPONSE MERGING
                             â”‚
                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      COMBINED RESPONSE                            â”‚
â”‚                                                                   â”‚
â”‚  {                                                                â”‚
â”‚    "response": "ğŸ—ºï¸ From your location in KadÄ±kÃ¶y...",          â”‚
â”‚    "map_data": {                                                 â”‚
â”‚      "type": "gps_route",                                        â”‚
â”‚      "user_location": {lat, lon},                                â”‚
â”‚      "route": {...},                                             â”‚
â”‚      "segments": [{walk}, {ferry}, {walk}],                      â”‚
â”‚      "markers": [...]                                            â”‚
â”‚    },                                                            â”‚
â”‚    "gps_used": true,                                             â”‚
â”‚    "rag_used": true,                                             â”‚
â”‚    "database_results": 5                                         â”‚
â”‚  }                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                               â”‚
                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      FRONTEND RENDERING                           â”‚
â”‚                                                                   â”‚
â”‚  â€¢ Text Response (directions, recommendations)                    â”‚
â”‚  â€¢ Interactive Map (Leaflet/Mapbox)                              â”‚
â”‚  â€¢ User Location Marker (ğŸ“)                                     â”‚
â”‚  â€¢ Route Visualization (colored path)                            â”‚
â”‚  â€¢ Transport Stops (ğŸš‡ğŸš¢ğŸšŠ)                                      â”‚
â”‚  â€¢ Walking Distance & Time                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Data Flow for GPS-Based Query

```
Step 1: User Query
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
User: "How do I get to Sultanahmet?"
GPS: {lat: 41.0082, lon: 28.9784}
        â”‚
        â†“
Step 2: Intent Detection
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Intent: "transportation"
GPS Detected: Yes (KadÄ±kÃ¶y area)
Needs Map: Yes
        â”‚
        â†“
Step 3: Parallel Processing
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ RAG Query      â”‚ Database Query â”‚ GPS Route Calc â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ KadÄ±kÃ¶y info â”‚ â€¢ Transport    â”‚ â€¢ Detect dist  â”‚
â”‚ â€¢ Sultanahmet  â”‚   options      â”‚ â€¢ Find hub     â”‚
â”‚ â€¢ Transport    â”‚ â€¢ Attractions  â”‚ â€¢ Calc route   â”‚
â”‚   connections  â”‚   nearby       â”‚ â€¢ Est. time    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚               â”‚                 â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                        â”‚
                        â†“
Step 4: Istanbul AI Processing
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input: Query + GPS + RAG Context
Process:
  â€¢ GPS Route Service: Calculate route
  â€¢ Transportation Handler: Get options
  â€¢ Map Generation: Create visualization
Output: map_data + detailed directions
        â”‚
        â†“
Step 5: LLM Enhancement
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Input: map_data + RAG context + DB results
LLM Generates:
  â€¢ Natural language directions
  â€¢ Step-by-step instructions
  â€¢ Local tips and insights
  â€¢ Time and distance info
Output: Enriched response text
        â”‚
        â†“
Step 6: Response Merge
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Combine:
  â€¢ LLM text response
  â€¢ Map visualization data
  â€¢ GPS coordinates
  â€¢ RAG context markers
  â€¢ Database metadata
        â”‚
        â†“
Step 7: Client Rendering
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Display:
  â€¢ Text in chat bubble
  â€¢ Interactive map below
  â€¢ Route with start/end markers
  â€¢ Transport stops highlighted
  â€¢ Walking segments shown
```

## ï¿½ï¿½ï¸ Map Generation Flow

```
Transportation Query
        â”‚
        â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Is GPS provided?                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  YES  â”‚           NO                  â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”´â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚        â”‚
    â†“        â†“
GPS Route    Named Route
(From user)  (From "X" to "Y")
    â”‚            â”‚
    â”‚            â”‚
    â†“            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  GPS Route Service                    â”‚
â”‚                                       â”‚
â”‚  â€¢ Detect current district            â”‚
â”‚  â€¢ Find nearest transport hub         â”‚
â”‚  â€¢ Calculate walking distance         â”‚
â”‚  â€¢ Get transit options                â”‚
â”‚  â€¢ Estimate total time                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Map System                           â”‚
â”‚                                       â”‚
â”‚  â€¢ Create route geometry              â”‚
â”‚  â€¢ Add user location marker           â”‚
â”‚  â€¢ Add waypoint markers               â”‚
â”‚  â€¢ Add transport stop markers         â”‚
â”‚  â€¢ Style by transport mode            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Map Data Output                      â”‚
â”‚                                       â”‚
â”‚  {                                    â”‚
â”‚    type: "gps_route",                 â”‚
â”‚    user_location: {...},              â”‚
â”‚    route: {                           â”‚
â”‚      coordinates: [[lng,lat], ...],   â”‚
â”‚      segments: [                      â”‚
â”‚        {type: "walk", distance: 500}, â”‚
â”‚        {type: "ferry", distance: 2500}â”‚
â”‚      ]                                â”‚
â”‚    },                                 â”‚
â”‚    markers: [...]                     â”‚
â”‚  }                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ RAG + Database Hybrid Query

```
User Query: "Turkish restaurants in KadÄ±kÃ¶y"
                    â”‚
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                      â”‚
        â†“                      â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  RAG Search      â”‚   â”‚  Database Query  â”‚
â”‚                  â”‚   â”‚                  â”‚
â”‚  Query:          â”‚   â”‚  SELECT * FROM   â”‚
â”‚  "KadÄ±kÃ¶y        â”‚   â”‚  restaurants     â”‚
â”‚   district       â”‚   â”‚  WHERE           â”‚
â”‚   Turkish food"  â”‚   â”‚  cuisine='Turk'  â”‚
â”‚                  â”‚   â”‚  AND             â”‚
â”‚  Results:        â”‚   â”‚  location='Kad'  â”‚
â”‚  â€¢ District info â”‚   â”‚                  â”‚
â”‚  â€¢ Characterist  â”‚   â”‚  Results:        â”‚
â”‚  â€¢ Transport     â”‚   â”‚  â€¢ 8 restaurants â”‚
â”‚  â€¢ Local tips    â”‚   â”‚  â€¢ Names, rating â”‚
â”‚                  â”‚   â”‚  â€¢ Coordinates   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Context Merger      â”‚
        â”‚                       â”‚
        â”‚  RAG Context:         â”‚
        â”‚  "KadÄ±kÃ¶y is the      â”‚
        â”‚   bohemian district   â”‚
        â”‚   on Asian side..."   â”‚
        â”‚                       â”‚
        â”‚  DB Results:          â”‚
        â”‚  [                    â”‚
        â”‚   {name: "Ã‡iya",      â”‚
        â”‚    rating: 4.5},      â”‚
        â”‚   {name: "Kanaat",    â”‚
        â”‚    rating: 4.3}       â”‚
        â”‚  ]                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   LLM Prompt          â”‚
        â”‚                       â”‚
        â”‚  System: You are      â”‚
        â”‚  Istanbul AI...       â”‚
        â”‚                       â”‚
        â”‚  Context: [RAG+DB]    â”‚
        â”‚                       â”‚
        â”‚  Query: User query    â”‚
        â”‚                       â”‚
        â”‚  Generate: Response   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚   Final Response      â”‚
        â”‚                       â”‚
        â”‚  ğŸ½ï¸ Turkish          â”‚
        â”‚  Restaurants in       â”‚
        â”‚  KadÄ±kÃ¶y              â”‚
        â”‚                       â”‚
        â”‚  KadÄ±kÃ¶y is the       â”‚
        â”‚  bohemian...          â”‚
        â”‚                       â”‚
        â”‚  1. Ã‡iya SofrasÄ±      â”‚
        â”‚     â‚ºâ‚º â€¢ 4.5â­        â”‚
        â”‚     Walking: 800m     â”‚
        â”‚                       â”‚
        â”‚  2. Kanaat...         â”‚
        â”‚                       â”‚
        â”‚  ğŸ’¡ Tip: These are    â”‚
        â”‚  in the market area   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§© Component Responsibilities

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Pure LLM Handler                         â”‚
â”‚  â€¢ Intent detection                                          â”‚
â”‚  â€¢ GPS extraction                                            â”‚
â”‚  â€¢ System routing                                            â”‚
â”‚  â€¢ Response orchestration                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     RAG Service                              â”‚
â”‚  â€¢ Semantic search                                           â”‚
â”‚  â€¢ District context                                          â”‚
â”‚  â€¢ Transportation info                                       â”‚
â”‚  â€¢ Local tips & insights                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     PostgreSQL Database                      â”‚
â”‚  â€¢ Structured data                                           â”‚
â”‚  â€¢ Restaurants (500+)                                        â”‚
â”‚  â€¢ Places (200+)                                             â”‚
â”‚  â€¢ Events, Museums                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Istanbul Daily Talk AI                   â”‚
â”‚  â€¢ Main orchestration                                        â”‚
â”‚  â€¢ Handler management                                        â”‚
â”‚  â€¢ GPS Route Service                                         â”‚
â”‚  â€¢ Map generation                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     GPS Route Service                        â”‚
â”‚  â€¢ Location detection                                        â”‚
â”‚  â€¢ Distance calculation                                      â”‚
â”‚  â€¢ Hub finding                                               â”‚
â”‚  â€¢ Route planning                                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     RunPod LLM (Llama 3.1)                   â”‚
â”‚  â€¢ Natural language generation                               â”‚
â”‚  â€¢ Context understanding                                     â”‚
â”‚  â€¢ Response formatting                                       â”‚
â”‚  â€¢ Multi-language support                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“¦ Technology Stack

```
Frontend
â”œâ”€â”€ React/Vue.js (UI)
â”œâ”€â”€ Leaflet/Mapbox (Maps)
â”œâ”€â”€ Geolocation API (GPS)
â””â”€â”€ Axios (HTTP client)

Backend API
â”œâ”€â”€ FastAPI (Web framework)
â”œâ”€â”€ Pydantic (Validation)
â””â”€â”€ Uvicorn (ASGI server)

AI/ML Layer
â”œâ”€â”€ RunPod LLM (Llama 3.1 8B)
â”œâ”€â”€ Sentence Transformers (Embeddings)
â”œâ”€â”€ ChromaDB (Vector database)
â””â”€â”€ Custom intent classifiers

Data Layer
â”œâ”€â”€ PostgreSQL (Structured data)
â”œâ”€â”€ Redis (Caching)
â””â”€â”€ JSON (Knowledge base)

Services
â”œâ”€â”€ RAG Service (Semantic search)
â”œâ”€â”€ GPS Route Service (Navigation)
â”œâ”€â”€ Istanbul Daily Talk AI (Orchestration)
â””â”€â”€ Map Generation (Visualization)

Infrastructure
â”œâ”€â”€ Docker (Containerization)
â”œâ”€â”€ AWS RDS (Database)
â”œâ”€â”€ Redis Cloud (Cache)
â””â”€â”€ OSRM (Route calculation)
```

## ğŸ¯ Query Type Matrix

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Query Type      â”‚   RAG   â”‚ Database â”‚   GPS   â”‚   Map    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Route Planning   â”‚    âœ…   â”‚    âŒ    â”‚   âœ…    â”‚    âœ…    â”‚
â”‚ Restaurant       â”‚    âœ…   â”‚    âœ…    â”‚   âš ï¸    â”‚    âœ…    â”‚
â”‚ Attractions      â”‚    âœ…   â”‚    âœ…    â”‚   âš ï¸    â”‚    âœ…    â”‚
â”‚ District Info    â”‚    âœ…   â”‚    âŒ    â”‚   âŒ    â”‚    âš ï¸    â”‚
â”‚ Transportation   â”‚    âœ…   â”‚    âŒ    â”‚   âœ…    â”‚    âœ…    â”‚
â”‚ Events           â”‚    âš ï¸   â”‚    âœ…    â”‚   âŒ    â”‚    âœ…    â”‚
â”‚ General Info     â”‚    âœ…   â”‚    âŒ    â”‚   âŒ    â”‚    âŒ    â”‚
â”‚ Nearby (GPS)     â”‚    âœ…   â”‚    âœ…    â”‚   âœ…    â”‚    âœ…    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

Legend:
âœ… = Always used
âš ï¸ = Conditionally used
âŒ = Not used
```

---

**This visual overview provides a complete picture of how all components work together!**
