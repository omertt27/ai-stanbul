[SERVICE]
    Flush        1
    Daemon       Off
    Log_Level    info
    HTTP_Server  On
    HTTP_Listen  0.0.0.0
    HTTP_Port    2020

[INPUT]
    Name         tail
    Path         /var/log/app/backend/*.log
    Tag          backend
    Parser       json
    Refresh_Interval 5

[INPUT]
    Name         tail
    Path         /var/log/app/nginx/*.log
    Tag          nginx
    Parser       nginx
    Refresh_Interval 5

[FILTER]
    Name         parser
    Match        backend
    Key_Name     message
    Parser       json
    Reserve_Data On

[OUTPUT]
    Name         stdout
    Match        *
    Format       json_lines

[PARSER]
    Name         json
    Format       json

[PARSER]
    Name         nginx
    Format       regex
    Regex        ^(?<remote>[^ ]*) (?<host>[^ ]*) (?<user>[^ ]*) \[(?<time>[^\]]*)\] "(?<method>\S+)(?: +(?<path>[^\"]*?)(?: +\S*)?)?" (?<code>[^ ]*) (?<size>[^ ]*)(?: "(?<referer>[^\"]*)" "(?<agent>[^\"]*)")?$
    Time_Key     time
    Time_Format  %d/%b/%Y:%H:%M:%S %z
